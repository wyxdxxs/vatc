<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>VATC 管制员小v</title>
    <style>
        body{max-width:700px;margin:20px auto;font-family:Arial}
        .chat-box{height:400px;border:1px solid #ccc;padding:10px;overflow-y:auto;margin-bottom:10px;border-radius:5px}
        .msg{margin:8px 0;padding:8px 12px;border-radius:8px}
        .user{background:#e3f2fd;text-align:right}
        .bot{background:#f5f5f5;text-align:left}
        input{width:78%;padding:10px}
        button{width:20%;padding:10px;cursor:pointer}
    </style>
</head>
<body>
    <h3>VATC 航空管制员小v</h3>
    <div class="chat-box" id="chat"></div>
    <input type="text" id="msg" placeholder="输入指令...">
    <button onclick="send()">发送</button>

    <script>
        async function send(){
            let text = document.getElementById('msg').value.trim();
            if(!text) return;
            let chat = document.getElementById('chat');
            chat.innerHTML += `<div class='msg user'>${text}</div>`;
            document.getElementById('msg').value = '';

            let res = await fetch('/chat', {
                method:'POST',
                headers:{'Content-Type':'application/json'},
                body:JSON.stringify({msg:text})
            });
            let data = await res.json();
            chat.innerHTML += `<div class='msg bot'>${data.reply}</div>`;
            chat.scrollTop = chat.scrollHeight;
        }
        document.getElementById('msg').addEventListener('keypress', e=>{
            if(e.key === 'Enter') send();
        });
    </script>
</body>
</html>
